file(GLOB_RECURSE PYTHON_FILES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} ${CMAKE_CURRENT_SOURCE_DIR}/*.py)

foreach(FNAME ${PYTHON_FILES})
  set(IN_FILE ${CMAKE_CURRENT_SOURCE_DIR}/${FNAME})
  set(OUT_FILE ${CMAKE_BINARY_DIR}/dist/python/mitsuba/${FNAME})
  add_custom_command(
    OUTPUT ${OUT_FILE} DEPENDS ${IN_FILE}
    COMMAND ${CMAKE_COMMAND} -E copy ${IN_FILE} ${OUT_FILE})
  list(APPEND PYTHON_FILES_OUT ${OUT_FILE})
endforeach()

add_custom_target(copy-python-modules ALL DEPENDS ${PYTHON_FILES_OUT})
