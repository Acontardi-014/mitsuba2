file(GLOB_RECURSE PYTHON_FILES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} ${CMAKE_CURRENT_SOURCE_DIR}/*.py)

foreach(FNAME ${PYTHON_FILES})
  set(IN_FILE ${CMAKE_CURRENT_SOURCE_DIR}/${FNAME})
  set(OUT_FILE ${CMAKE_BINARY_DIR}/dist/python/mitsuba/${FNAME})
  add_custom_command(
    OUTPUT ${OUT_FILE} DEPENDS ${IN_FILE}
    COMMAND ${CMAKE_COMMAND} -E copy ${IN_FILE} ${OUT_FILE})
  set(PYTHON_OUTPUT ${PYTHON_OUTPUT} ${OUT_FILE})
endforeach()

add_custom_target(python-copy ALL DEPENDS ${PYTHON_OUTPUT})
set_property(TARGET python-copy PROPERTY FOLDER misc)